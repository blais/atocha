===============================
   atocha: Web Forms Library
===============================

.. contents::


Description
===========

Atocha is a Python library for *parsing* and *rendering* data from web forms.
It is framework-agnostic, generic, and it should be possible to use it with CGI
scrips or to incorporate it in your favourite web application framework


Motivation
----------

Just before I decided to write this software (2005-09-30), I had the following
problems:

- There was no library that could parse input from widgets and perform automatic
  types conversions reliably, that was both decent and **simple**, or that was
  not tied to a specific web application framework.  (A few options were
  starting to sprout and mature around that time, such as FormEncode_);

- I was having lots of trouble in the various data paths of my handlers with
  type conversions, often having unicode encoding problems;

- I felt that the problem of handling and rendering web forms were really tied
  closely, and that it could be solved in a generic manner.

At the time, I had written my own web application framework, and a small form
library I had copied from somewhere had grown into a messy monster. So I decided
to attack the problem directly and rewrite my forms handling generically, with
the following goals in mind:

#. Reuse the form definition for parsing submitted arguments as well as
   rendering and displaying data (leverage the knowledge stored in the form
   definition as much as possible);

#. Robustness: an emphasis on **strict type checking** and robustness via tests;

#. Fields automatically perform appropriate type conversion when returning the
   parsed value to the user; Like desktop UI toolkit widgets, fields may return
   all sorts of data types.  Also, fields can use multiple HTML input widgets,
   the notion of input and its mechanism are separate.

Essentially, I wanted functionality closer to what desktop UI toolkits provide,
which is often not present in web form parsing toolkits.


Documentation
=============

Ultimately, you'll have to delve into the heavily documented code to find out
about all the gory details, but the simple introduction in this section will
give you a taste for what the library can do for you.

Some documents:

- `Overview and Tutorial <doc/tutorial.html>`_
- `Fields Reference List <doc/fields.html>`_
- `Design Notes <doc/design.html>`_
- `Data Flow and Data Paths <doc/handpath.html>`_
- `Developer's Guide <doc/develop.html>`_


Features
========

- **Generic** library that is possible to reused in many frameworks and
  applications.  It is not tied to any storage model or domain model, this
  library provides the data, and you must then store the data yourself. This
  makes sense, as user-interfaces may change but the underlying data model
  remain the same;

- **Extensible**: it is easy to create and add new field types without having to
  modify the framework.  It is also possible to create renderers for your
  favourite output library (e.g. Stan)

- Fields may render to **multiple input widgets** and are consolidated in a
  single value automatically;

- **Internationalization (I18n)** of all messages is supported (all messages
  generated by the library are grouped in a s single place and can be easily
  customized);

- Supports hidden widgets for **multiple-page forms**;

- Supports **per-field errors**, to be rendered next to the erroneous widgets;

- Supports a UI message and status for the re-rendering a form with errors;

- Could easily be extended to support widgets with JavaScript/AJAX code.

Online Demo
===========

You can try an online demo of a form with all the available widgets, that was
implemented using simple CGI scripts.  You can visit the source code from the
demo web pages too.

- `Online Demo -- Try It Now! <test/demo/cgi-bin/display.cgi>`_

.. note:: This simple demo does not use session management, so if many people
          access it at the same time you may be surprised by other people's
          values appearing in the results.


Download
========

Snapshots of the latest pipexcel source code can be found in the Download_ area.
If you make any modification to the source, please update and run the tests.

.. _Download: /downloads/atocha

Reporting Bugs
==============

Bugs
----

If you find bugs, send email to the author: Martin Blais <blais@furius.ca>.  I
share my source code in the hope that other users will provide feedback to
improve stability.  Contributions are also welcome.

Support and Stability
---------------------

I am actively using this library to build a commercial-grade web application and
will actively improve and support the library.  There is a test suite that runs
through the basic features of the library.


Links
=====

- Another similar project is the FormEncode library (author: Ian Bicking):
  http://formencode.org/.

  FormEncode_ is a nice effort, which aims at solving the very same problem as
  this project.  My comments on FormEncode_, in comparison to Atocha:

  * I don't like having to write validator classes, I like to put my validation
    code inside my resource handler code, because it is pretty much always
    different for every form, so there is not much opportunity for reuse anyway.
    For the few cases where I do validate results the same way, I simply write a
    function that uses the parser object;

  * I find all the metaclass stuff in FormEncode_ entirely unnecessary and very
    distracting.  I like code that is lean and simple;

  * I need to use an HTML output library that is a tree of nodes (htmlout) and
    so I really needed to have decoupled renderer code that produces only nodes
    rather than text;

  * I don't know if the kind of per-error message with the ability to specify an
    invalid replacement value for re-rendering can be produced as easily as with
    Atocha (I would need to study FormEncode to find out).

  That being said, I did not really make an effort to try to use FormEncode_, at
  the time when I discovered it I had already pretty much finished my library.

.. _FormEncode: http://formencode.org/


Installation and Dependencies
=============================

- Python >=2.3


Copyright and License
=====================

Copyright (C) 2005  Martin Blais.
This code is distributed under the `GNU General Public License <COPYING>`_.


Acknowledgements
================

The Atocha library has evolved a lot from my original use of the form.py file in
the `draco framework`__ written by Geert Jansen.  I originally copied and
modified the file quite a bit, and at some point I got really frustrated in my
mess, being constantly in data type conversion hell and decided to rewrite the
whole thing completely, with a particular emphasis on identifying and checking
the types which flow throughout the life of a request.

__ http://draco.boskant.nl/


Author
======

Martin Blais <blais@furius.ca>

